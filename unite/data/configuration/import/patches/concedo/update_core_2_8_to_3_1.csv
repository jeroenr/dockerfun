## load the new permissions for document attachement

## config 1 / KERNEL update

# Rename permissions needed ??
@SQL,UPDATE IBANX_PERM SET P_CODE = '103' WHERE P_CODE = '102'
@SQL,UPDATE IBANX_PERM SET P_CODE = '102' WHERE P_CODE = '101'
@SQL,UPDATE IBANX_PERM SET P_CODE = '101' WHERE P_CODE = '100'

## corerole mapping including hardcoded ID required for as long as the organizationservice (and others) have not been rewritten to not
## differentiate between the implicit and non implicit roles (delete code likes CODE_EVERYONE from OrganizationRoles and
## start refactoring)
corerole,1,everyone,nl::iedereen;en::everyone;de::jedermann;es::todo el mundo;fr::tous
corerole,2,anonymous,nl::anoniem;en::anonymous;de::anonym;es::anÃ³nimo;fr::anonyme
corerole,3,owner,nl::eigenaar;en::owner;de::inhaber;es::poseedor;fr::anonyme
corerole,4,assignee,nl::gemachtigde;en::assignee,true,true
corerole,5,creator,nl::maker;en::creator;de::autor;es::creador;fr::auteur

@delete,vitem,groupName,boolean,=
vitem,boolean,true,Yes,Yes,Yes,true,false,nl::Ja;en::Yes;de::Ja
vitem,boolean,false,No,No,No,true,false,nl::Nee;en::No;de::Nein

## rename all ACL's using the SQL script from SCQ 1.3->1.6 update (from update_core_1_3_x_to_1_6.csv)
## change acl names to strict use of naming regime
## mysql
@SQL,UPDATE IBANX_ACL AS ACL\, IBANX_LIFECYCLE_STATE AS STATE\, IBANX_LIFECYCLE AS LC SET ACL.NAME = CONCAT('StateAcl '\, LC.NR\,'-'\,STATE.NAME) WHERE ACL.ID = STATE.STATE_ACL_ID AND STATE.LIFECYCLE_ID = LC.ID,mysql
## oracle
@SQL,MERGE INTO IBANX_ACL N_ACL USING (SELECT ACL.ID ID\,  CONCAT('StateAcl '\, CONCAT(LC.NR\, CONCAT('-'\,STATE.NAME))) NEW_NAME FROM IBANX_ACL ACL\, IBANX_LIFECYCLE_STATE STATE\, IBANX_LIFECYCLE LC WHERE ACL.ID = STATE.STATE_ACL_ID AND STATE.LIFECYCLE_ID = LC.ID) T_ACL ON (N_ACL.ID = T_ACL.ID) WHEN MATCHED THEN UPDATE SET N_ACL.NAME = T_ACL.NEW_NAME,oracle
## mssql
@SQL,UPDATE IBANX_ACL SET NAME = 'StateAcl ' + LC.NR + '-' + STATE.NAME FROM IBANX_ACL ACL\, IBANX_LIFECYCLE_STATE STATE\, IBANX_LIFECYCLE LC WHERE ACL.ID = STATE.STATE_ACL_ID AND STATE.LIFECYCLE_ID = LC.ID,mssql

## config 2 UPDATE

## Change from ORG to DEFAULT_PLANT bot for organizations
## Add new DEFAULT_SITE bot for parent

businessobjecttype,DEFAULT_SITE,,Site,,,,,Site,ibanx.org.OrganizationIF,ORG_STATE,-1,-1,null,GLOBAL,true,null,null,null,null,null,false
@startTransaction
@method,set,businessobjecttype,DEFAULT_SITE,class0,site
@endTransaction

businessobjecttype,DEFAULT_PLANT,,Plant,,,,,Plant,ibanx.org.OrganizationIF,ORG_STATE,-1,-1,null,GLOBAL,true,null,null,null,null,null,false
@startTransaction
@method,set,businessobjecttype,DEFAULT_PLANT,class0,plant
@endTransaction

@method,set,queryspec,ALL-PLANTS,form.businessObjectType.number,DEFAULT_PLANT
@method,set,queryspec,ALL-PLANTS-IDENTITY,form.businessObjectType.number,DEFAULT_PLANT

## change possible organization of type ORG to DEFAULT_PLANT
@SQL,UPDATE IBANX_ORGANIZATION SET BO_TYPE_ID=(SELECT ID FROM IBANX_BOT WHERE NR='DEFAULT_PLANT') WHERE BO_TYPE_ID=(SELECT ID FROM IBANX_BOT WHERE NR='ORG') AND NR <> 'GLOBAL';